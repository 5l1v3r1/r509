<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta name="Content-Type" content="text/html; charset=en_us" />
<title>Class: R509::Crl</title>
<link rel="stylesheet" href="../css/style.css" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '..';
  if (relpath != '') relpath += '/';
</script>
<script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/app.js"></script>

  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="../_index.html">Index (C)</a> &raquo; 
    <span class='title'><span class='object_link'><a href="../R509.html" title="R509 (module)">R509</a></span></span>
     &raquo; 
    <span class="title">Crl</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  <a id="class_list_link" href="#">Class List</a>
  <a id="method_list_link" href="#">Method List</a>
  <a id ="file_list_link" href="#">File List</a>
</div>

      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><h1>Class: R509::Crl
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">R509::Crl</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
      <dt class="r2">Includes:</dt>
      <dd class="r2"><span class='object_link'><a href="IOHelpers.html" title="R509::IOHelpers (module)">IOHelpers</a></span></dd>
      
    
  
  
  
    <dt class="r1 last">Defined in:</dt>
    <dd class="r1 last">lib/r509/Crl.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>Used to generate CRLs</p>


  </div>
</div>
<div class="tags">
  
</div>

  
  
  
  
  <h2>Instance Attribute Summary <small>(<a href="#" class="summary_toggle">collapse</a>)</small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#crl_list_file-instance_method" title="#crl_list_file (instance method)">- (Object) <strong>crl_list_file</strong> </a>
    

    
  </span>
  
  
    <span class="note title readonly">readonly</span>
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute crl_list_file.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#crl_number-instance_method" title="#crl_number (instance method)">- (Object) <strong>crl_number</strong> </a>
    

    
  </span>
  
  
    <span class="note title readonly">readonly</span>
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute crl_number.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#crl_number_file-instance_method" title="#crl_number_file (instance method)">- (Object) <strong>crl_number_file</strong> </a>
    

    
  </span>
  
  
    <span class="note title readonly">readonly</span>
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute crl_number_file.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#validity_hours-instance_method" title="#validity_hours (instance method)">- (Object) <strong>validity_hours</strong> </a>
    

    
  </span>
  
  
    <span class="note title readonly">readonly</span>
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute validity_hours.</p>
</div></span>
  
</li>

    
  </ul>


  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#generate_crl-instance_method" title="#generate_crl (instance method)">- (String) <strong>generate_crl</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Remove serial from revocation list.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">- (Crl) <strong>initialize</strong>(config) </a>
    

    
  </span>
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>A new instance of Crl.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#last_update-instance_method" title="#last_update (instance method)">- (Time) <strong>last_update</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the signing time of the CRL.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#next_update-instance_method" title="#next_update (instance method)">- (Time) <strong>next_update</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the next update time for the CRL.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#revoke_cert-instance_method" title="#revoke_cert (instance method)">- (Object) <strong>revoke_cert</strong>(serial, reason = nil, revoke_time = Time.now.to_i, generate_and_save = true) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Adds a certificate to the revocation list.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#revoked%3F-instance_method" title="#revoked? (instance method)">- (Boolean True if the serial number was revoked. False, otherwise.) <strong>revoked?</strong>(serial) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Indicates whether the serial number has been revoked, or not.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#revoked_cert-instance_method" title="#revoked_cert (instance method)">- (Array) <strong>revoked_cert</strong>(serial) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Serial, reason, revoke_time tuple.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#revoked_certs-instance_method" title="#revoked_certs (instance method)">- (Array&lt;Array&gt;) <strong>revoked_certs</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns an array of serial, reason, revoke_time tuples.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#save_crl_list-instance_method" title="#save_crl_list (instance method)">- (Object) <strong>save_crl_list</strong>(filename_or_io = @crl_list_file) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Saves the CRL list to a filename or IO.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#save_crl_number-instance_method" title="#save_crl_number (instance method)">- (Object) <strong>save_crl_number</strong>(filename_or_io = @crl_number_file) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Save the CRL number to a filename or IO.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#to_der-instance_method" title="#to_der (instance method)">- (String) <strong>to_der</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the CRL in DER format.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#to_pem-instance_method" title="#to_pem (instance method)">- (String) <strong>to_pem</strong> </a>
    

    
      (also: #to_s)
    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the CRL in PEM format.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#unrevoke_cert-instance_method" title="#unrevoke_cert (instance method)">- (Object) <strong>unrevoke_cert</strong>(serial) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Remove serial from revocation list.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#write_der-instance_method" title="#write_der (instance method)">- (Object) <strong>write_der</strong>(filename_or_io) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Writes the CRL into the PEM format.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#write_pem-instance_method" title="#write_pem (instance method)">- (Object) <strong>write_pem</strong>(filename_or_io) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Writes the CRL into the PEM format.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="IOHelpers.html" title="R509::IOHelpers (module)">IOHelpers</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="IOHelpers.html#read_data-instance_method" title="R509::IOHelpers#read_data (method)">#read_data</a></span>, <span class='object_link'><a href="IOHelpers.html#write_data-instance_method" title="R509::IOHelpers#write_data (method)">#write_data</a></span></p>
<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <p class="signature first" id="initialize-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="R509::Crl (class)">Crl</a></span></tt>) <strong>initialize</strong>(config) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>A new instance of Crl</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='type'>(<tt><span class='object_link'><a href="Config/CaConfig.html" title="R509::Config::CaConfig (class)">R509::Config::CaConfig</a></span></tt>)</span>
      
      
        <span class='name'></span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/r509/Crl.rb', line 14</span>

<span class='def def kw'>def</span> <span class='initialize identifier id'>initialize</span><span class='lparen token'>(</span><span class='config identifier id'>config</span><span class='rparen token'>)</span>
    <span class='@config ivar id'>@config</span> <span class='assign token'>=</span> <span class='config identifier id'>config</span>

    <span class='unless unless kw'>unless</span> <span class='@config ivar id'>@config</span><span class='dot token'>.</span><span class='kind_of? fid id'>kind_of?</span><span class='lparen token'>(</span><span class='R509 constant id'>R509</span><span class='colon2 op'>::</span><span class='Config constant id'>Config</span><span class='colon2 op'>::</span><span class='CaConfig constant id'>CaConfig</span><span class='rparen token'>)</span>
        <span class='raise identifier id'>raise</span> <span class='R509Error constant id'>R509Error</span><span class='comma token'>,</span> <span class='string val'>&quot;config must be a kind of R509::Config::CaConfig&quot;</span>
    <span class='end end kw'>end</span>

    <span class='@validity_hours ivar id'>@validity_hours</span> <span class='assign token'>=</span> <span class='@config ivar id'>@config</span><span class='dot token'>.</span><span class='crl_validity_hours identifier id'>crl_validity_hours</span>
    <span class='@start_skew_seconds ivar id'>@start_skew_seconds</span> <span class='assign token'>=</span> <span class='@config ivar id'>@config</span><span class='dot token'>.</span><span class='crl_start_skew_seconds identifier id'>crl_start_skew_seconds</span>
    <span class='@crl ivar id'>@crl</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>

    <span class='@crl_number_file ivar id'>@crl_number_file</span> <span class='assign token'>=</span> <span class='@config ivar id'>@config</span><span class='dot token'>.</span><span class='crl_number_file identifier id'>crl_number_file</span>
    <span class='if if kw'>if</span> <span class='not not kw'>not</span> <span class='@crl_number_file ivar id'>@crl_number_file</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
        <span class='@crl_number ivar id'>@crl_number</span> <span class='assign token'>=</span> <span class='read_data identifier id'>read_data</span><span class='lparen token'>(</span><span class='@crl_number_file ivar id'>@crl_number_file</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
    <span class='else else kw'>else</span>
        <span class='@crl_number ivar id'>@crl_number</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
    <span class='end end kw'>end</span>


    <span class='@crl_list_file ivar id'>@crl_list_file</span> <span class='assign token'>=</span> <span class='@config ivar id'>@config</span><span class='dot token'>.</span><span class='crl_list_file identifier id'>crl_list_file</span>
    <span class='load_crl_list identifier id'>load_crl_list</span><span class='lparen token'>(</span><span class='@crl_list_file ivar id'>@crl_list_file</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id=""></span>
      <span id="crl_list_file-instance_method"></span>
      <div class="method_details first">
  <p class="signature first" id="crl_list_file-instance_method">
  
    - (<tt>Object</tt>) <strong>crl_list_file</strong>  <span class="extras">(readonly)</span>
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute crl_list_file</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


11
12
13</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/r509/Crl.rb', line 11</span>

<span class='def def kw'>def</span> <span class='crl_list_file identifier id'>crl_list_file</span>
  <span class='@crl_list_file ivar id'>@crl_list_file</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <span id="crl_number-instance_method"></span>
      <div class="method_details ">
  <p class="signature " id="crl_number-instance_method">
  
    - (<tt>Object</tt>) <strong>crl_number</strong>  <span class="extras">(readonly)</span>
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute crl_number</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


11
12
13</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/r509/Crl.rb', line 11</span>

<span class='def def kw'>def</span> <span class='crl_number identifier id'>crl_number</span>
  <span class='@crl_number ivar id'>@crl_number</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <span id="crl_number_file-instance_method"></span>
      <div class="method_details ">
  <p class="signature " id="crl_number_file-instance_method">
  
    - (<tt>Object</tt>) <strong>crl_number_file</strong>  <span class="extras">(readonly)</span>
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute crl_number_file</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


11
12
13</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/r509/Crl.rb', line 11</span>

<span class='def def kw'>def</span> <span class='crl_number_file identifier id'>crl_number_file</span>
  <span class='@crl_number_file ivar id'>@crl_number_file</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <span id="validity_hours-instance_method"></span>
      <div class="method_details ">
  <p class="signature " id="validity_hours-instance_method">
  
    - (<tt>Object</tt>) <strong>validity_hours</strong>  <span class="extras">(readonly)</span>
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute validity_hours</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


11
12
13</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/r509/Crl.rb', line 11</span>

<span class='def def kw'>def</span> <span class='validity_hours identifier id'>validity_hours</span>
  <span class='@validity_hours ivar id'>@validity_hours</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="generate_crl-instance_method">
  
    - (<tt>String</tt>) <strong>generate_crl</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Remove serial from revocation list</p>


  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
      
        &mdash;
        <div class='inline'>
<p>PEM encoded signed CRL</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/r509/Crl.rb', line 146</span>

<span class='def def kw'>def</span> <span class='generate_crl identifier id'>generate_crl</span>
    <span class='crl identifier id'>crl</span> <span class='assign token'>=</span> <span class='OpenSSL constant id'>OpenSSL</span><span class='colon2 op'>::</span><span class='X509 constant id'>X509</span><span class='colon2 op'>::</span><span class='CRL constant id'>CRL</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
    <span class='crl identifier id'>crl</span><span class='dot token'>.</span><span class='version identifier id'>version</span> <span class='assign token'>=</span> <span class='integer val'>1</span>
    <span class='now identifier id'>now</span> <span class='assign token'>=</span> <span class='Time constant id'>Time</span><span class='dot token'>.</span><span class='at identifier id'>at</span> <span class='Time constant id'>Time</span><span class='dot token'>.</span><span class='now identifier id'>now</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
    <span class='crl identifier id'>crl</span><span class='dot token'>.</span><span class='last_update identifier id'>last_update</span> <span class='assign token'>=</span> <span class='now identifier id'>now</span><span class='minus op'>-</span><span class='@start_skew_seconds ivar id'>@start_skew_seconds</span>
    <span class='crl identifier id'>crl</span><span class='dot token'>.</span><span class='next_update identifier id'>next_update</span> <span class='assign token'>=</span> <span class='now identifier id'>now</span><span class='plus op'>+</span><span class='@validity_hours ivar id'>@validity_hours</span><span class='mult op'>*</span><span class='integer val'>3600</span>
    <span class='crl identifier id'>crl</span><span class='dot token'>.</span><span class='issuer identifier id'>issuer</span> <span class='assign token'>=</span> <span class='@config ivar id'>@config</span><span class='dot token'>.</span><span class='ca_cert identifier id'>ca_cert</span><span class='dot token'>.</span><span class='issuer identifier id'>issuer</span>

    <span class='self self kw'>self</span><span class='dot token'>.</span><span class='revoked_certs identifier id'>revoked_certs</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='serial identifier id'>serial</span><span class='comma token'>,</span> <span class='reason identifier id'>reason</span><span class='comma token'>,</span> <span class='revoke_time identifier id'>revoke_time</span><span class='bitor op'>|</span>
        <span class='revoked identifier id'>revoked</span> <span class='assign token'>=</span> <span class='OpenSSL constant id'>OpenSSL</span><span class='colon2 op'>::</span><span class='X509 constant id'>X509</span><span class='colon2 op'>::</span><span class='Revoked constant id'>Revoked</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
        <span class='revoked identifier id'>revoked</span><span class='dot token'>.</span><span class='serial identifier id'>serial</span> <span class='assign token'>=</span> <span class='OpenSSL constant id'>OpenSSL</span><span class='colon2 op'>::</span><span class='BN constant id'>BN</span><span class='dot token'>.</span><span class='new identifier id'>new</span> <span class='serial identifier id'>serial</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span>
        <span class='revoked identifier id'>revoked</span><span class='dot token'>.</span><span class='time identifier id'>time</span> <span class='assign token'>=</span> <span class='Time constant id'>Time</span><span class='dot token'>.</span><span class='at identifier id'>at</span><span class='lparen token'>(</span><span class='revoke_time identifier id'>revoke_time</span><span class='rparen token'>)</span>
        <span class='if if kw'>if</span> <span class='notop op'>!</span><span class='reason identifier id'>reason</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
            <span class='enum identifier id'>enum</span> <span class='assign token'>=</span> <span class='OpenSSL constant id'>OpenSSL</span><span class='colon2 op'>::</span><span class='ASN1 constant id'>ASN1</span><span class='colon2 op'>::</span><span class='Enumerated constant id'>Enumerated</span><span class='lparen token'>(</span><span class='reason identifier id'>reason</span><span class='rparen token'>)</span> <span class='comment val'>#see reason codes below</span>
            <span class='ext identifier id'>ext</span> <span class='assign token'>=</span> <span class='OpenSSL constant id'>OpenSSL</span><span class='colon2 op'>::</span><span class='X509 constant id'>X509</span><span class='colon2 op'>::</span><span class='Extension constant id'>Extension</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='string val'>&quot;CRLReason&quot;</span><span class='comma token'>,</span> <span class='enum identifier id'>enum</span><span class='rparen token'>)</span>
            <span class='revoked identifier id'>revoked</span><span class='dot token'>.</span><span class='add_extension identifier id'>add_extension</span><span class='lparen token'>(</span><span class='ext identifier id'>ext</span><span class='rparen token'>)</span>
        <span class='end end kw'>end</span>
        <span class='comment val'>#now add it to the crl</span>
        <span class='crl identifier id'>crl</span><span class='dot token'>.</span><span class='add_revoked identifier id'>add_revoked</span><span class='lparen token'>(</span><span class='revoked identifier id'>revoked</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>

    <span class='ef identifier id'>ef</span> <span class='assign token'>=</span> <span class='OpenSSL constant id'>OpenSSL</span><span class='colon2 op'>::</span><span class='X509 constant id'>X509</span><span class='colon2 op'>::</span><span class='ExtensionFactory constant id'>ExtensionFactory</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
    <span class='ef identifier id'>ef</span><span class='dot token'>.</span><span class='issuer_certificate identifier id'>issuer_certificate</span> <span class='assign token'>=</span> <span class='@config ivar id'>@config</span><span class='dot token'>.</span><span class='ca_cert identifier id'>ca_cert</span><span class='dot token'>.</span><span class='cert identifier id'>cert</span>
    <span class='ef identifier id'>ef</span><span class='dot token'>.</span><span class='crl identifier id'>crl</span> <span class='assign token'>=</span> <span class='crl identifier id'>crl</span>
    <span class='comment val'>#grab crl number from file, increment, write back</span>
    <span class='crl_number identifier id'>crl_number</span> <span class='assign token'>=</span> <span class='increment_crl_number identifier id'>increment_crl_number</span>
    <span class='crlnum identifier id'>crlnum</span> <span class='assign token'>=</span> <span class='OpenSSL constant id'>OpenSSL</span><span class='colon2 op'>::</span><span class='ASN1 constant id'>ASN1</span><span class='colon2 op'>::</span><span class='Integer constant id'>Integer</span><span class='lparen token'>(</span><span class='crl_number identifier id'>crl_number</span><span class='rparen token'>)</span>
    <span class='crl identifier id'>crl</span><span class='dot token'>.</span><span class='add_extension identifier id'>add_extension</span><span class='lparen token'>(</span><span class='OpenSSL constant id'>OpenSSL</span><span class='colon2 op'>::</span><span class='X509 constant id'>X509</span><span class='colon2 op'>::</span><span class='Extension constant id'>Extension</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='string val'>&quot;crlNumber&quot;</span><span class='comma token'>,</span> <span class='crlnum identifier id'>crlnum</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
    <span class='extensions identifier id'>extensions</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
    <span class='extensions identifier id'>extensions</span> <span class='lshft op'>&lt;&lt;</span> <span class='lbrack token'>[</span><span class='string val'>&quot;authorityKeyIdentifier&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;keyid:always,issuer:always&quot;</span><span class='comma token'>,</span> <span class='false false kw'>false</span><span class='rbrack token'>]</span>
    <span class='extensions identifier id'>extensions</span><span class='dot token'>.</span><span class='each identifier id'>each</span><span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='oid identifier id'>oid</span><span class='comma token'>,</span> <span class='value identifier id'>value</span><span class='comma token'>,</span> <span class='critical identifier id'>critical</span><span class='bitor op'>|</span>
        <span class='crl identifier id'>crl</span><span class='dot token'>.</span><span class='add_extension identifier id'>add_extension</span><span class='lparen token'>(</span><span class='ef identifier id'>ef</span><span class='dot token'>.</span><span class='create_extension identifier id'>create_extension</span><span class='lparen token'>(</span><span class='oid identifier id'>oid</span><span class='comma token'>,</span> <span class='value identifier id'>value</span><span class='comma token'>,</span> <span class='critical identifier id'>critical</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
    <span class='rbrace token'>}</span>
    <span class='crl identifier id'>crl</span><span class='dot token'>.</span><span class='sign identifier id'>sign</span><span class='lparen token'>(</span><span class='@config ivar id'>@config</span><span class='dot token'>.</span><span class='ca_cert identifier id'>ca_cert</span><span class='dot token'>.</span><span class='key identifier id'>key</span><span class='dot token'>.</span><span class='key identifier id'>key</span><span class='comma token'>,</span> <span class='OpenSSL constant id'>OpenSSL</span><span class='colon2 op'>::</span><span class='Digest constant id'>Digest</span><span class='colon2 op'>::</span><span class='SHA1 constant id'>SHA1</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='rparen token'>)</span>
    <span class='@crl ivar id'>@crl</span> <span class='assign token'>=</span> <span class='crl identifier id'>crl</span>
    <span class='@crl ivar id'>@crl</span><span class='dot token'>.</span><span class='to_pem identifier id'>to_pem</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="last_update-instance_method">
  
    - (<tt>Time</tt>) <strong>last_update</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Returns the signing time of the CRL</p>


  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>Time</tt>)</span>
      
      
      
      
        &mdash;
        <div class='inline'>
<p>when the CRL was signed</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


85
86
87</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/r509/Crl.rb', line 85</span>

<span class='def def kw'>def</span> <span class='last_update identifier id'>last_update</span>
    <span class='@crl ivar id'>@crl</span><span class='dot token'>.</span><span class='last_update identifier id'>last_update</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="next_update-instance_method">
  
    - (<tt>Time</tt>) <strong>next_update</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Returns the next update time for the CRL</p>


  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>Time</tt>)</span>
      
      
      
      
        &mdash;
        <div class='inline'>
<p>when it will be updated next</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


92
93
94</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/r509/Crl.rb', line 92</span>

<span class='def def kw'>def</span> <span class='next_update identifier id'>next_update</span>
    <span class='@crl ivar id'>@crl</span><span class='dot token'>.</span><span class='next_update identifier id'>next_update</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="revoke_cert-instance_method">
  
    - (<tt>Object</tt>) <strong>revoke_cert</strong>(serial, reason = nil, revoke_time = Time.now.to_i, generate_and_save = true) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Adds a certificate to the revocation list. After calling you must call
generate_crl to sign a new CRL</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
        <span class='name'>serial</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>serial number of the certificate to revoke</p>
</div>
      
    </li>
  
    <li>
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
        <span class='name'>reason</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>reason for revocation</p>
</div>
      
    </li>
  
    <li>
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
        <span class='name'>revoke_time</span>
      
      
        <em class="default">(defaults to: <tt>Time.now.to_i</tt>)</em>
      
      
    </li>
  
    <li>
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <span class='name'>generate_and_save</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>whether we want to generate the CRL and save its file (default=true)</p>

<p>reason codes defined by rfc 5280 CRLReason ::= ENUMERATED {</p>

<pre class="code"><span class='unspecified identifier id'>unspecified</span>             <span class='lparen token'>(</span><span class='integer val'>0</span><span class='rparen token'>)</span><span class='comma token'>,</span>
<span class='keyCompromise identifier id'>keyCompromise</span>           <span class='lparen token'>(</span><span class='integer val'>1</span><span class='rparen token'>)</span><span class='comma token'>,</span>
<span class='cACompromise identifier id'>cACompromise</span>            <span class='lparen token'>(</span><span class='integer val'>2</span><span class='rparen token'>)</span><span class='comma token'>,</span>
<span class='affiliationChanged identifier id'>affiliationChanged</span>      <span class='lparen token'>(</span><span class='integer val'>3</span><span class='rparen token'>)</span><span class='comma token'>,</span>
<span class='superseded identifier id'>superseded</span>              <span class='lparen token'>(</span><span class='integer val'>4</span><span class='rparen token'>)</span><span class='comma token'>,</span>
<span class='cessationOfOperation identifier id'>cessationOfOperation</span>    <span class='lparen token'>(</span><span class='integer val'>5</span><span class='rparen token'>)</span><span class='comma token'>,</span>
<span class='certificateHold identifier id'>certificateHold</span>         <span class='lparen token'>(</span><span class='integer val'>6</span><span class='rparen token'>)</span><span class='comma token'>,</span>
<span class='removeFromCRL identifier id'>removeFromCRL</span>           <span class='lparen token'>(</span><span class='integer val'>8</span><span class='rparen token'>)</span><span class='comma token'>,</span>
<span class='privilegeWithdrawn identifier id'>privilegeWithdrawn</span>      <span class='lparen token'>(</span><span class='integer val'>9</span><span class='rparen token'>)</span><span class='comma token'>,</span>
<span class='aACompromise identifier id'>aACompromise</span>           <span class='lparen token'>(</span><span class='integer val'>10</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
</pre>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/r509/Crl.rb', line 115</span>

<span class='def def kw'>def</span> <span class='revoke_cert identifier id'>revoke_cert</span><span class='lparen token'>(</span><span class='serial identifier id'>serial</span><span class='comma token'>,</span><span class='reason identifier id'>reason</span><span class='assign token'>=</span><span class='nil nil kw'>nil</span><span class='comma token'>,</span> <span class='revoke_time identifier id'>revoke_time</span><span class='assign token'>=</span><span class='Time constant id'>Time</span><span class='dot token'>.</span><span class='now identifier id'>now</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span><span class='comma token'>,</span> <span class='generate_and_save identifier id'>generate_and_save</span><span class='assign token'>=</span><span class='true true kw'>true</span><span class='rparen token'>)</span>
    <span class='if if kw'>if</span> <span class='not not kw'>not</span> <span class='reason identifier id'>reason</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span><span class='dot token'>.</span><span class='between? fid id'>between?</span><span class='lparen token'>(</span><span class='integer val'>0</span><span class='comma token'>,</span><span class='integer val'>10</span><span class='rparen token'>)</span>
        <span class='reason identifier id'>reason</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
    <span class='end end kw'>end</span>
    <span class='serial identifier id'>serial</span> <span class='assign token'>=</span> <span class='serial identifier id'>serial</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
    <span class='reason identifier id'>reason</span> <span class='assign token'>=</span> <span class='reason identifier id'>reason</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
    <span class='revoke_time identifier id'>revoke_time</span> <span class='assign token'>=</span> <span class='revoke_time identifier id'>revoke_time</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
    <span class='if if kw'>if</span> <span class='revoked? fid id'>revoked?</span><span class='lparen token'>(</span><span class='serial identifier id'>serial</span><span class='rparen token'>)</span>
        <span class='raise identifier id'>raise</span> <span class='R509 constant id'>R509</span><span class='colon2 op'>::</span><span class='R509Error constant id'>R509Error</span><span class='comma token'>,</span> <span class='string val'>&quot;Cannot revoke a previously revoked certificate&quot;</span>
    <span class='end end kw'>end</span>
    <span class='@revoked_certs ivar id'>@revoked_certs</span><span class='lbrack token'>[</span><span class='serial identifier id'>serial</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='symbol val'>:reason</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='reason identifier id'>reason</span><span class='comma token'>,</span> <span class='symbol val'>:revoke_time</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='revoke_time identifier id'>revoke_time</span><span class='rbrace token'>}</span>
    <span class='if if kw'>if</span> <span class='generate_and_save identifier id'>generate_and_save</span>
        <span class='generate_crl identifier id'>generate_crl</span><span class='lparen token'>(</span><span class='rparen token'>)</span>
        <span class='save_crl_list identifier id'>save_crl_list</span><span class='lparen token'>(</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
    <span class='nil nil kw'>nil</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="revoked?-instance_method">
  
    - (<tt>Boolean True if the serial number was revoked. False</tt>, <tt>otherwise.</tt>) <strong>revoked?</strong>(serial) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Indicates whether the serial number has been revoked, or not.</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
        <span class='name'>serial</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The serial number we want to check</p>
</div>
      
    </li>
  
</ul>
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>Boolean True if the serial number was revoked. False</tt>, <tt>otherwise.</tt>)</span>
      
      
      
      
        &mdash;
        <div class='inline'>
<p>Boolean True if the serial number was revoked. False, otherwise.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


41
42
43</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/r509/Crl.rb', line 41</span>

<span class='def def kw'>def</span> <span class='revoked? fid id'>revoked?</span><span class='lparen token'>(</span><span class='serial identifier id'>serial</span><span class='rparen token'>)</span>
  <span class='@revoked_certs ivar id'>@revoked_certs</span><span class='dot token'>.</span><span class='has_key? fid id'>has_key?</span><span class='lparen token'>(</span><span class='serial identifier id'>serial</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="revoked_cert-instance_method">
  
    - (<tt>Array</tt>) <strong>revoked_cert</strong>(serial) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Serial, reason, revoke_time tuple</p>


  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>Array</tt>)</span>
      
      
      
      
        &mdash;
        <div class='inline'>
<p>serial, reason, revoke_time tuple</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


46
47
48</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/r509/Crl.rb', line 46</span>

<span class='def def kw'>def</span> <span class='revoked_cert identifier id'>revoked_cert</span><span class='lparen token'>(</span><span class='serial identifier id'>serial</span><span class='rparen token'>)</span>
    <span class='@revoked_certs ivar id'>@revoked_certs</span><span class='lbrack token'>[</span><span class='serial identifier id'>serial</span><span class='rbrack token'>]</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="revoked_certs-instance_method">
  
    - (<tt>Array&lt;Array&gt;</tt>) <strong>revoked_certs</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Returns an array of serial, reason, revoke_time tuples.</p>


  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>Array&lt;Array&gt;</tt>)</span>
      
      
      
      
        &mdash;
        <div class='inline'>
<p>Returns an array of serial, reason, revoke_time tuples.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


186
187
188
189
190
191
192</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/r509/Crl.rb', line 186</span>

<span class='def def kw'>def</span> <span class='revoked_certs identifier id'>revoked_certs</span>
    <span class='ret identifier id'>ret</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
    <span class='@revoked_certs ivar id'>@revoked_certs</span><span class='dot token'>.</span><span class='keys identifier id'>keys</span><span class='dot token'>.</span><span class='sort identifier id'>sort</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='serial identifier id'>serial</span><span class='bitor op'>|</span>
        <span class='ret identifier id'>ret</span> <span class='lshft op'>&lt;&lt;</span> <span class='lbrack token'>[</span><span class='serial identifier id'>serial</span><span class='comma token'>,</span> <span class='@revoked_certs ivar id'>@revoked_certs</span><span class='lbrack token'>[</span><span class='serial identifier id'>serial</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='symbol val'>:reason</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='@revoked_certs ivar id'>@revoked_certs</span><span class='lbrack token'>[</span><span class='serial identifier id'>serial</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='symbol val'>:revoke_time</span><span class='rbrack token'>]</span><span class='rbrack token'>]</span>
    <span class='end end kw'>end</span>
    <span class='ret identifier id'>ret</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="save_crl_list-instance_method">
  
    - (<tt>Object</tt>) <strong>save_crl_list</strong>(filename_or_io = @crl_list_file) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Saves the CRL list to a filename or IO. If the class was initialized with
:crl_list_file, then the filename specified by that will be used by
default.</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='type'>(<tt>String</tt>, <tt>#write</tt>, <tt>nil</tt>)</span>
      
      
        <span class='name'>filename_or_io</span>
      
      
        <em class="default">(defaults to: <tt>@crl_list_file</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>If provided, the generated crl will be written to either the file (if a
string), or IO. If nil, then the @crl_list_file will be used. If that is
nil, then an error will be raised.</p>
</div>
      
    </li>
  
</ul>
<h3>Raises:</h3>
<ul class="raise">
  
    <li>
      
        <span class='type'>(<tt><span class='object_link'><a href="R509Error.html" title="R509::R509Error (class)">R509Error</a></span></tt>)</span>
      
      
      
      
        &mdash;
        <div class='inline'>
<p>Raised if there’s no @crl_list_file to save to.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


202
203
204
205
206
207
208
209
210
211</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/r509/Crl.rb', line 202</span>

<span class='def def kw'>def</span> <span class='save_crl_list identifier id'>save_crl_list</span><span class='lparen token'>(</span><span class='filename_or_io identifier id'>filename_or_io</span> <span class='assign token'>=</span> <span class='@crl_list_file ivar id'>@crl_list_file</span><span class='rparen token'>)</span>
    <span class='return return kw'>return</span> <span class='nil nil kw'>nil</span> <span class='if if_mod kw'>if</span> <span class='filename_or_io identifier id'>filename_or_io</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>

    <span class='data identifier id'>data</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
    <span class='self self kw'>self</span><span class='dot token'>.</span><span class='revoked_certs identifier id'>revoked_certs</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='serial identifier id'>serial</span><span class='comma token'>,</span> <span class='reason identifier id'>reason</span><span class='comma token'>,</span> <span class='revoke_time identifier id'>revoke_time</span><span class='bitor op'>|</span>
        <span class='data identifier id'>data</span> <span class='lshft op'>&lt;&lt;</span> <span class='lbrack token'>[</span><span class='serial identifier id'>serial</span><span class='comma token'>,</span> <span class='revoke_time identifier id'>revoke_time</span><span class='comma token'>,</span> <span class='reason identifier id'>reason</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='string val'>','</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
    <span class='write_data identifier id'>write_data</span><span class='lparen token'>(</span><span class='filename_or_io identifier id'>filename_or_io</span><span class='comma token'>,</span> <span class='data identifier id'>data</span><span class='dot token'>.</span><span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='string val'>&quot;\n&quot;</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
    <span class='nil nil kw'>nil</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="save_crl_number-instance_method">
  
    - (<tt>Object</tt>) <strong>save_crl_number</strong>(filename_or_io = @crl_number_file) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Save the CRL number to a filename or IO. If the class was initialized with
:crl_number_file, then the filename specified by that will be used by
default.</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='type'>(<tt>String</tt>, <tt>#write</tt>, <tt>nil</tt>)</span>
      
      
        <span class='name'>filename_or_io</span>
      
      
        <em class="default">(defaults to: <tt>@crl_number_file</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>If provided, the current crl number will be written to either the file (if
a string), or IO. If nil, then the @crl_number_file will be used. If that
is nil, then an error will be raised.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


220
221
222
223
224
225
226</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/r509/Crl.rb', line 220</span>

<span class='def def kw'>def</span> <span class='save_crl_number identifier id'>save_crl_number</span><span class='lparen token'>(</span><span class='filename_or_io identifier id'>filename_or_io</span> <span class='assign token'>=</span> <span class='@crl_number_file ivar id'>@crl_number_file</span><span class='rparen token'>)</span>
    <span class='return return kw'>return</span> <span class='nil nil kw'>nil</span> <span class='if if_mod kw'>if</span> <span class='filename_or_io identifier id'>filename_or_io</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
    <span class='comment val'># No valid filename or IO was specified, so bail.</span>

    <span class='write_data identifier id'>write_data</span><span class='lparen token'>(</span><span class='filename_or_io identifier id'>filename_or_io</span><span class='comma token'>,</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='crl_number identifier id'>crl_number</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span><span class='rparen token'>)</span>
    <span class='nil nil kw'>nil</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="to_der-instance_method">
  
    - (<tt>String</tt>) <strong>to_der</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Returns the CRL in DER format</p>


  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
      
        &mdash;
        <div class='inline'>
<p>the CRL in DER format</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


62
63
64</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/r509/Crl.rb', line 62</span>

<span class='def def kw'>def</span> <span class='to_der identifier id'>to_der</span>
    <span class='@crl ivar id'>@crl</span><span class='dot token'>.</span><span class='to_der identifier id'>to_der</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="to_pem-instance_method">
  
    - (<tt>String</tt>) <strong>to_pem</strong> 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='to_s-instance_method'>to_s</span></span>
    </span>
  
</p><div class="docstring">
  <div class="discussion">
    
<p>Returns the CRL in PEM format</p>


  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
      
        &mdash;
        <div class='inline'>
<p>the CRL in PEM format</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


53
54
55</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/r509/Crl.rb', line 53</span>

<span class='def def kw'>def</span> <span class='to_pem identifier id'>to_pem</span>
    <span class='@crl ivar id'>@crl</span><span class='dot token'>.</span><span class='to_pem identifier id'>to_pem</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="unrevoke_cert-instance_method">
  
    - (<tt>Object</tt>) <strong>unrevoke_cert</strong>(serial) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Remove serial from revocation list. After unrevoking you must call
generate_crl to sign a new CRL</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
        <span class='name'>serial</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>serial number of the certificate to remove from revocation</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


136
137
138
139
140
141</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/r509/Crl.rb', line 136</span>

<span class='def def kw'>def</span> <span class='unrevoke_cert identifier id'>unrevoke_cert</span><span class='lparen token'>(</span><span class='serial identifier id'>serial</span><span class='rparen token'>)</span>
    <span class='@revoked_certs ivar id'>@revoked_certs</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='serial identifier id'>serial</span><span class='rparen token'>)</span>
    <span class='generate_crl identifier id'>generate_crl</span><span class='lparen token'>(</span><span class='rparen token'>)</span>
    <span class='save_crl_list identifier id'>save_crl_list</span><span class='lparen token'>(</span><span class='rparen token'>)</span>
    <span class='nil nil kw'>nil</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="write_der-instance_method">
  
    - (<tt>Object</tt>) <strong>write_der</strong>(filename_or_io) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Writes the CRL into the PEM format</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='type'>(<tt>String</tt>, <tt>#write</tt>)</span>
      
      
        <span class='name'>filename_or_io</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Either a string of the path for the file that you’d like to write, or an
IO-like object.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


78
79
80</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/r509/Crl.rb', line 78</span>

<span class='def def kw'>def</span> <span class='write_der identifier id'>write_der</span><span class='lparen token'>(</span><span class='filename_or_io identifier id'>filename_or_io</span><span class='rparen token'>)</span>
    <span class='write_data identifier id'>write_data</span><span class='lparen token'>(</span><span class='filename_or_io identifier id'>filename_or_io</span><span class='comma token'>,</span> <span class='@crl ivar id'>@crl</span><span class='dot token'>.</span><span class='to_der identifier id'>to_der</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="write_pem-instance_method">
  
    - (<tt>Object</tt>) <strong>write_pem</strong>(filename_or_io) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Writes the CRL into the PEM format</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='type'>(<tt>String</tt>, <tt>#write</tt>)</span>
      
      
        <span class='name'>filename_or_io</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Either a string of the path for the file that you’d like to write, or an
IO-like object.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


70
71
72</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/r509/Crl.rb', line 70</span>

<span class='def def kw'>def</span> <span class='write_pem identifier id'>write_pem</span><span class='lparen token'>(</span><span class='filename_or_io identifier id'>filename_or_io</span><span class='rparen token'>)</span>
    <span class='write_data identifier id'>write_data</span><span class='lparen token'>(</span><span class='filename_or_io identifier id'>filename_or_io</span><span class='comma token'>,</span> <span class='@crl ivar id'>@crl</span><span class='dot token'>.</span><span class='to_pem identifier id'>to_pem</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>
    
    <div id="footer">
  Generated on Tue Dec 27 14:58:01 2011 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.6.4 (ruby-1.8.7).
</div>

  </body>
</html>